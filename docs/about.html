<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>psci3200-camilacp03 - Research Design 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">psci3200-camilacp03</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./about.html" rel="" target="" aria-current="page">
 <span class="menu-text">Research Design 1</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Research Design 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Research Design 1</p>
<p>Research Question:</p>
<p>How does party fragmentation affect voter turnout and other measures of democratic strength in developing representative democracies?</p>
<p>Rationale and Datasets:</p>
<p>There are a number of studies in electoral research that have attempted to investigate the relationship between party fragmentation and measures of democratic strength. The direction of the effect, however, is widely disputed among political scientists. On the one hand, some scholars argue that greater fragmentation fosters pluralism, representation, and policy innovation by ensuring that a wider range of political interests are represented in the decision-making process. This, in turn, can enhance democratic legitimacy and participation. Other researchers contend that high levels of fragmentation can lead to governmental instability, inefficiency, and legislative gridlock, ultimately weakening democratic performance.</p>
<p>Multiple measures of democracy have been studied in the literature, including governmental stability, accountability, corruption, turnout, public goods provision, female representation and the representation of minorities (Valentim and Dias, 2023). The empirical findings from these studies are often contradictory concerning the direction of the effect of party fragmentation on democratic quality, even when comparing the same indicators.</p>
<p>A number of studies have also focused on characterizing the specific relationship between party fragmentation and political participation, measured by voter turnout. A large group of scholars argues that party system fragmentation likely depresses turnout since citizens vote for a small part of the government which will likely form a coalition to rule. Additionally, each individual candidate has a lower likelihood of winning elections in a fragmented party system, which may also discourage voter turnout. In empirical research, party fragmentation has also been found to be negatively correlated with voter turnout (Franklin and de Miño 1998; Geys and Heyndels 2006; Henderson and McEwen 2010; Jackman and Milner 1995; Kostadinova and Power 2007; Lehoucq and Wall 2004; Radcliff and Davis 2000). However, there is also empirical evidence pointing to a positive relationship between party fragmentation and voter turnout&nbsp; (Banducci and Karp 2009), though the authors find a stronger relationship when regressing on party polarization. The theoretical foundation behind this research is that a greater number of parties may increase voter turnout by providing more ideological options that align with citizens’ preferences, thereby encouraging participation. However, some scholars argue that an excessive number of parties can dilute ideological clarity and create confusion, potentially discouraging voter engagement.</p>
<p>All of the studies above that use country-level aggregate data focus on industrialized democracies. The justification for this is that those kinds of regimes are more consolidated democracies with very limited experience with authoritarianism and where the right to vote is generally guaranteed. Other studies have limited their research to a number of elections in a particular country, hoping to control for the endogeneity of political parties. I intend to empirically examine the relationship between political party fragmentation and voter turnout in developing democracies, particularly in Latin America. To avoid the aforementioned issues, I will establish a cutoff point based on scores of democratic strength provided by Freedom House and V-Dem. I will also complement the country choice with qualitative research to ensure that voting rights are respected to a high degree in all countries selected. My intent with studying a different subset of countries is to test whether the results and theoretical rationale from established democracies also explain the variation in emerging ones.</p>
<p>I only found one study that empirically tested the relationship between party fragmentation and voter turnout in Latin America. Carew Boulding and David S. Brown examine this topic in their study, “Does the number of political parties influence voter turnout in developing democracies?” Their research focuses on Brazil and Bolivia, concluding that differences in electoral systems shape the relationship between party competition and voter turnout. They find that in Bolivia, an increase in the number of parties is strongly associated with higher turnout, while in Brazil, the relationship is weaker and slightly negative. However, their study is limited to only two countries, which constrains the generalizability of their findings.</p>
<p>Data and Research Design</p>
<p>To examine this relationship, I will use data from the Constituency-Level Elections Archive (CLEA) and Varieties of Democracy (V-Dem). The particular dataset I am using to run this particular preliminary analysis is the CLEA Upper Chamber Elections Archive (I believe the links to the datasets for upper chamber and lower chamber are switched in the website based on the descriptions of each dataset). This dataset includes 181 elections from 24 countries. I am hoping to use a larger dataset in subsequent steps of the project to capture the relationship between the variables in developing countries, but this dataset will be a starting point to identify a preliminary pattern in the data. I use an upper chamber election dataset instead of presidential, gubernatorial, or mayoral elections to minimize differences in voting incentives between parliamentary and presidential systems.</p>
<p>Variables:</p>
<p>Dependent variable:</p>
<p>Voter turnout (measured in percentage)</p>
<p>Independent variable:</p>
<p>Party fragmentation (Measured by the number of political parties present in the government)&nbsp;</p>
<p>Other measures of the strength of democracy (will be included in subsequent stages)</p>
<p>Control variables:</p>
<p>Dummy variable indicating whether the country has compulsory voting (will be included in subsequent stages)</p>
<p>Each observation in the dataset corresponds to the performance of a specific party in a given election. Since I intend to have each election as a unit of observation, I have combined the number of rows that correspond to the same election and created an additional column for the number of parties that participated in each. The variable num_parties corresponds to the number of parties and the variable to1 is the percentage of voter participation in that given election.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the CSV file</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/camilaparanhos/Downloads/Elections_Filtered.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows where num_parties or to1 have negative values which correspond to N/A</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>elections_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data, num_parties <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> to1 <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the scatter plot</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(elections_data, <span class="fu">aes</span>(<span class="at">x =</span> to1, <span class="at">y =</span> num_parties)) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Voter Turnout in %"</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Parties"</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Scatterplot of Number of Parties vs Voter Turnout"</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="about_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Regression Model</p>
<p>I will run a linear regression using the following formula to test the hypotheses presented in this proposal:</p>
<p>Voter_Turnout_it = beta_0 + beta_1 * Party_Fragmentation_it + beta_2 * Compulsory_Voting_it + epsilon_it</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create linear regression model</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>regression_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(to1 <span class="sc">~</span> num_parties, <span class="at">data =</span> elections_data)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the model summary</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regression_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = to1 ~ num_parties, data = elections_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48722 -0.11416  0.03333  0.14427  0.28889 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 6.633e-01  2.826e-02  23.474   &lt;2e-16 ***
num_parties 2.599e-05  5.124e-04   0.051     0.96    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1962 on 106 degrees of freedom
Multiple R-squared:  2.427e-05, Adjusted R-squared:  -0.009409 
F-statistic: 0.002572 on 1 and 106 DF,  p-value: 0.9596</code></pre>
</div>
</div>
<p>In this preliminary version of the model, there is no statistically significant relationship between the number of parties and voter turnout, which may not be the case if more variables are added as controls to the model.</p>
<p>Later on, I intend to test robustness by running models with both legislative and presidential turnout data to see if results differ.&nbsp;</p>
<p>However, one concern that was addressed by Valentim and Elias (2014) is the endogeneity of political parties that are specific to the political context of the countries in which they operate. The authors argue that this endogeneity may bias results and contribute to the ambiguity of results in empirical scholarly research on party fragmentation and voter turnout. Therefore, I am also considering a regression model that includes the use of an Instrumental Variable to mitigate the endogeneity risk. This could be a variable that affects party fragmentation but not directly related to voter turnout. Before setting in a specific IV, I would test out different IVs and see how correlated they are to each of the variables. Some potential instruments include whether the country has a federal or unitary system of government, and&nbsp; the geographic size of a country or total population. In this case, the Two-Stage Least Squares (2SLS) IV Regression Model would be as follows:&nbsp;</p>
<p>First stage: Predicting party fragmentation with an instrument</p>
<p>Party_Fragmentation_it = alpha_0 + alpha_1 * Instrument_it + alpha_2 * Compulsory_Voting_it + nu_it</p>
<p>Second stage: Using the predicted party fragmentation in the turnout model</p>
<p>Voter_Turnout_it = beta_0 + beta_1 * Party_Fragmentation_hat_it + beta_2 * Compulsory_Voting_it + epsilon_it</p>
<p>Another research design I am considering would be to perform a Difference-in-Differences (DiD) analysis leveraging potential electoral reforms in Latin American countries that changed the number of contesting parties to assess their impact on voter turnout before and after the reform.</p>
<p>Bibliography</p>
<p>Banducci SA and Karp JA (2009) Electoral systems, efficacy, and voter turnout, in Klingemann H-D (ed.), The Comparative Study of Electoral Systems. Oxford: Oxford University Press, 109–36.</p>
<p>Franklin MN and de Miño WPH (1998) Separated powers, divided government, and turnout in U.S. Presidential elections. American Journal of Political Science 42(1), 316–26.</p>
<p>Geys B and Heyndels B (2006) Disentangling the effects of political fragmentation on voter turnout: The Flemish municipal elections. Economics &amp; Politics 18(3), 367–87.</p>
<p>Henderson A and McEwen N (2010) A comparative analysis of voter turnout in regional elections. Electoral Studies 29(3), 405–16.</p>
<p>Jackman RW and Milner RA (1995) Voter turnout in industrial democracies during the 1980s. Comparative Political Studies 27(4), 467–92.</p>
<p>Kostadinova T and Power TJ (2007) Does democratization depress participation? Voter turnout in the Latin American and Eastern European transitional democracies. Political Research Quarterly 60(3), 363–77.</p>
<p>Lehoucq F and Wall DL (2004) Explaining voter turnout rates in new democracies: Guatemala. Electoral Studies 23(3), 485–500.</p>
<p>Radcliff B and Davis P (2000) Labor organization and electoral participation in industrial democracies. American Journal of Political Science 44(1), 132–41.</p>
<p>Valentim, Vicente, and Elias Dinas. 2024. “Does Party-System Fragmentation Affect the Quality of Democracy?” British Journal of Political Science 54(1): 152–78. Doi: 10.1017/S0007123423000157.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>